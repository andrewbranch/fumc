<h1 class="ui header">Bulletins</h1>

<button class="ui blue button" {{action 'newBulletin'}}>New Bulletin</button>

<div class="ui selection link divided list">
	{{#each bulletin in controller}}
		<div {{bind-attr class=":item :bulletin bulletin.editing: editing"}}>
			<div class="ui grid">

				<div class="row" {{action 'toggleEditing'}}>
					<div class="one wide column">
						{{#if bulletin.visible}}
							<i class="unhide icon"></i>
						{{/if}}
					</div>
					<div class="eleven wide column">
						<div class="header">{{bulletin.formattedDate}}</div>
						{{bulletin.service}}
					</div>
					<div class="four wide right column">
						{{#if bulletin.file}}
							<button class="ui small black button" {{action 'viewFile' bubbles=false}}>View</button>
						{{/if}}
						<button class="ui small red button" {{action 'remove' bubbles=false}}>Delete</button>
					</div>
				</div>

				<div {{bind-attr class=":editing :row :slide bulletin.editing::hidden"}}>
					<div class="sixteen wide column">
						<form class="ui fluid form">
							<div class="field">
								{{file-upload oldFile=bulletin.file change="fileSelected"}}
							</div>
							<div class="two fields">
								<div class="field">
									<label>Service</label>
									<div class="ui left labeled input">
										{{input value=bulletin.service placeholder="e.g. ICON"}}
										{{#if errors.service}}
											<div class="ui red pointing above label">{{errors.service}}</div>
										{{/if}}
									</div>
								</div>
								<div class="date field">
									<label>Service Date</label>
									<div class="ui left labeled input">
										{{view Fumc.DateField date=bulletin.date}}
										{{#if errors.date}}
											<div class="ui red pointing above label">{{errors.date}}</div>
										{{/if}}
									</div>
								</div>
							</div>
							<div class="field">
								<div class="ui checkbox">
									{{input type="checkbox" checked=bulletin.visible}}
									<label>Publish to app/website</label>
								</div>
							</div>
							<div class="ui buttons field">
								<button class="ui button" {{action 'cancel'}}>Cancel</button>
								<div class="or"></div>
								<button {{bind-attr class=":ui :blue :button bulletin.fileUpload.isUploading:disabled"}} {{action 'save'}}>Save</button>
							</div>
							<div {{bind-attr class=":ui :blue :progress bulletin.fileUpload.showProgressBar::hidden bulletin.fileUpload.didUpload:successful"}}>
								<div class="bar" {{bind-attr style="bulletin.fileUpload.progressStyle"}}></div>
							</div>
						</form>
					</div>
				</div>

			</div>
		</div>
	{{/each}}
</div>

{{#basic-modal class="file-viewer" initialize="registerModal" title=showBulletinTitle}}{{/basic-modal}}
